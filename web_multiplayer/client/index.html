<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Racing Game Online</title>
  <link rel="stylesheet" href="/client/style.css" />
</head>
<body>
  <div class="layout">
    <div class="hud">
      <h1>Racing Game Online (Beta)</h1>
      <div class="controls-row top-row">
        <label>Room
          <input id="roomInput" value="brands-public" maxlength="24" />
        </label>
        <label>Name
          <input id="nameInput" value="Player" maxlength="18" />
        </label>
        <button id="connectBtn">Connect</button>
        <button id="fullscreenBtn">Fullscreen</button>
      </div>

      <div class="controls-row">
        <label>Garage Car
          <select id="carSelect"></select>
        </label>
        <label>Track
          <select id="trackSelect"></select>
        </label>
        <label>Laps
          <select id="lapsSelect">
            <option value="1">1</option>
            <option value="3" selected>3</option>
            <option value="5">5</option>
          </select>
        </label>
        <button id="applyTrackBtn">Use Track</button>
        <button id="openDesignerBtn">Map Designer</button>
        <button id="readyBtn">Ready</button>
        <button id="startRaceBtn">Start Race</button>
        <button id="resetLobbyBtn">Reset Lobby</button>
      </div>

      <div class="custom-map-box" id="customMapBox">
        <div class="designer-header">
          <h3>Map Designer</h3>
          <button id="closeDesignerBtn" type="button">Close</button>
        </div>
        <p class="designer-hint">Draw the track below, then click <strong>Host From Editor</strong>.</p>
        <div class="map-editor-toolbar">
          <label>W <input id="mapWidthInput" type="number" min="16" max="128" value="64" /></label>
          <label>H <input id="mapHeightInput" type="number" min="12" max="96" value="48" /></label>
          <label>Spawn
            <select id="spawnDirectionSelect">
              <option value="90">Up</option>
              <option value="180">Right</option>
              <option value="270">Down</option>
              <option value="0">Left</option>
            </select>
          </label>
          <button id="resizeMapBtn" type="button">Resize</button>
          <button id="loadCurrentTrackBtn" type="button">Load Current Track</button>
          <button id="clearEditorBtn" type="button">Clear</button>
        </div>
        <div class="map-editor-tiles">
          <button id="toolWallBtn" class="tile-tool active" data-tile="1" type="button">Wall (1)</button>
          <button id="toolRoadBtn" class="tile-tool" data-tile="." type="button">Road (.)</button>
          <button id="toolStartBtn" class="tile-tool" data-tile="P" type="button">Start (P)</button>
          <button id="toolFinishBtn" class="tile-tool" data-tile="F" type="button">Finish (F)</button>
          <button id="toolCheckpointBtn" class="tile-tool" data-tile="C" type="button">Checkpoint (C)</button>
        </div>
        <canvas id="mapEditorCanvas" width="768" height="384"></canvas>
        <button id="hostCustomMapBtn">Host From Editor</button>

        <details class="advanced-map-text">
          <summary>Advanced: paste/edit raw map text</summary>
          <label for="customMapInput">Rows using only 1 . P F C (exactly one P)</label>
          <textarea id="customMapInput" rows="5" placeholder="Optional: paste map rows here..."></textarea>
          <div class="advanced-map-actions">
            <button id="textToEditorBtn" type="button">Load Text Into Editor</button>
            <button id="hostTextMapBtn" type="button">Host From Text</button>
          </div>
        </details>
      </div>

      <p id="statusText">Disconnected</p>
      <p id="phaseText">Phase: lobby</p>
      <p class="hint">Controls: WASD/Arrows drive, Space = handbrake</p>

      <div class="panels">
        <div class="panel-block">
          <h3>Room Leaderboard</h3>
          <ul id="roomLeaderboard"></ul>
        </div>
        <div class="panel-block">
          <h3>Global Leaderboard</h3>
          <ul id="globalLeaderboard"></ul>
        </div>
      </div>
    </div>

    <div class="game-area" id="gameArea">
      <canvas id="gameCanvas" width="1024" height="768"></canvas>
      <div class="race-info-box" id="raceInfoBox">
        <h3>Race Info</h3>
        <div class="race-info-row"><span>Lap</span><span id="hudLap">-</span></div>
        <div class="race-info-row"><span>Lap Time</span><span id="hudLapTime">00:00.000</span></div>
        <div class="race-info-row"><span>Race Time</span><span id="hudRaceTime">00:00.000</span></div>
        <div class="race-info-row"><span>Best Lap</span><span id="hudBestLap">--:--.---</span></div>
        <div class="race-info-row"><span>Speed</span><span id="hudSpeed">0</span></div>
        <div class="race-info-row"><span>Ping</span><span id="hudPing">-- ms</span></div>
        <div class="race-info-row"><span>Phase</span><span id="hudPhase">lobby</span></div>
      </div>
    </div>
  </div>

  <script type="module" src="/client/app.js"></script>
</body>
</html>
